{"file": {"path": "/Users/dakixr/Desktop/github/scc/tmp-data/metadata/KnowledgeCaptureAndDiscoveryANDmintproject/topoflow36/topoflow/utils/calibrate.py", "fileNameBase": "calibrate", "extension": "py"}, "dependencies": [{"import": "glob", "type": "external"}, {"import": "os", "type": "external"}, {"import": "os", "type": "external"}, {"import": "shutil", "type": "external"}, {"import": "sys", "type": "external"}, {"import": "time", "type": "external"}, {"import": "numpy", "alias": "np", "type": "external"}, {"from_module": "scipy.interpolate", "import": "interp1d", "type": "external"}, {"from_module": "scipy.stats", "import": "spearmanr", "type": "external"}, {"from_module": "topoflow.framework", "import": "emeli", "type": "external"}, {"from_module": "topoflow.utils", "import": "parameterize", "type": "external"}, {"from_module": "topoflow.utils", "import": "time_utils", "alias": "tu", "type": "external"}, {"from_module": "topoflow.utils", "import": "visualize", "alias": "tfvis", "type": "external"}, {"from_module": "topoflow", "import": "main", "type": "external"}], "classes": {"calibrator": {"min_max_lineno": {"min_lineno": 78, "max_lineno": 1059}, "methods": {"__init__": {"args": ["self", "cfg_file"], "min_max_lineno": {"min_lineno": 80, "max_lineno": 85}, "calls": ["calibrate.calibrator.set_info"]}, "read_cfg_file": {"args": ["self", "delim"], "min_max_lineno": {"min_lineno": 88, "max_lineno": 166}, "calls": ["open", "topoflow.utils.time_utils.standardize_datetime_str", "os.path.exists", "os.path.exists", "os.path.exists", "os.path.exists", "print", "print", "print", "print", "open.readline", "calibrate.calibrator.basin_dir.replace", "calibrate.calibrator.topo_dir.replace", "calibrate.calibrator.obs_dir.replace", "calibrate.calibrator.cfg_dir.replace", "calibrate.calibrator.output_dir.replace", "open.readline.split", "parts[].strip", "parts[].strip", "exec", "int", "locals", "float"], "store_vars_calls": {"cfg_unit": "open", "self.obs_start_datetime": "tu.standardize_datetime_str", "line": "cfg_unit.readline", "self.basin_dir": "self.basin_dir.replace", "self.topo_dir": "self.topo_dir.replace", "self.obs_dir": "self.obs_dir.replace", "self.cfg_dir": "self.cfg_dir.replace", "self.output_dir": "self.output_dir.replace", "parts": "line.split", "key": "parts[].strip", "value": "float"}}, "set_info": {"args": ["self"], "min_max_lineno": {"min_lineno": 169, "max_lineno": 228}, "calls": ["os.path.expanduser", "os.path.expanduser", "os.path.expanduser", "os.path.expanduser", "calibrate.calibrator.read_cfg_file"]}, "print_file_info": {"args": ["self"], "min_max_lineno": {"min_lineno": 231, "max_lineno": 248}, "calls": ["print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print"]}, "print_cfg_info": {"args": ["self"], "min_max_lineno": {"min_lineno": 251, "max_lineno": 291}, "calls": ["print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print"]}, "read_time_series": {"args": ["self", "source", "SILENT", "time_type"], "min_max_lineno": {"min_lineno": 294, "max_lineno": 374}, "calls": ["open", "range", "list", "list", "open.close", "numpy.array", "numpy.array", "open.readline", "open.readline", "open.readline.split", "len", "numpy.float32", "numpy.array.append", "numpy.array.append", "print", "print", "print", "print", "print", "print", "numpy.array.copy", "numpy.array.copy", "print", "print", "print", "numpy.float32", "numpy.array.min", "numpy.array.max", "numpy.array.min", "numpy.array.max"], "store_vars_calls": {"file_unit": "open", "times": "np.array", "values": "np.array", "line": "file_unit.readline", "words": "line.split", "ncols": "len", "value": "np.float32", "self.obs_times_orig": "times.copy", "self.obs_values_orig": "values.copy", "time": "np.float32"}}, "interpolate_obs_time_series": {"args": ["self", "SILENT"], "min_max_lineno": {"min_lineno": 383, "max_lineno": 456}, "calls": ["scipy.interpolate.interp1d", "scipy.interpolate.interp1d.", "print", "print", "print", "print"], "store_vars_calls": {"f1": "interp1d", "self.obs_values": "f1"}}, "interpolate_sim_time_series": {"args": ["self", "SILENT"], "min_max_lineno": {"min_lineno": 459, "max_lineno": 497}, "calls": ["scipy.interpolate.interp1d", "scipy.interpolate.interp1d.", "print", "print", "print", "print"], "store_vars_calls": {"f1": "interp1d", "self.sim_values": "f1"}}, "convert_obs_time_format": {"args": ["self"], "min_max_lineno": {"min_lineno": 500, "max_lineno": 537}, "calls": ["topoflow.utils.time_utils.convert_times_from_hhmm_to_minutes", "numpy.zeros", "range", "topoflow.utils.time_utils.get_datetime_obj_from_one_str", "topoflow.utils.time_utils.convert_times_from_datetime_to_minutes", "topoflow.utils.time_utils.get_datetime_obj_from_one_str", "topoflow.utils.time_utils.convert_times_from_datetime_to_minutes"], "store_vars_calls": {"self.obs_times": "tu.convert_times_from_datetime_to_minutes", "times_datetime": "np.zeros", "origin_datetime_obj": "tu.get_datetime_obj_from_one_str"}}, "get_observed_values": {"args": ["self", "SILENT"], "min_max_lineno": {"min_lineno": 540, "max_lineno": 652}, "calls": ["calibrate.calibrator.read_time_series", "calibrate.calibrator.convert_obs_time_format", "print", "calibrate.calibrator.interpolate_obs_time_series", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "print", "calibrate.calibrator.obs_values.min", "calibrate.calibrator.obs_values.max", "calibrate.calibrator.obs_values_orig.min", "calibrate.calibrator.obs_values_orig.max", "calibrate.calibrator.obs_times.min", "calibrate.calibrator.obs_times.max"]}, "get_simulated_values": {"args": ["self", "SILENT"], "min_max_lineno": {"min_lineno": 655, "max_lineno": 689}, "calls": ["calibrate.calibrator.read_time_series", "print", "print", "print", "print", "print", "print", "print", "print", "calibrate.calibrator.sim_times.min", "calibrate.calibrator.sim_times.max", "calibrate.calibrator.sim_values.min", "calibrate.calibrator.sim_values.max"]}, "modify_cfg_file": {"args": ["self", "p"], "min_max_lineno": {"min_lineno": 692, "max_lineno": 696}}, "backup_input_file": {"args": ["self", "file_type"], "min_max_lineno": {"min_lineno": 699, "max_lineno": 716}, "calls": ["shutil.copyfile"]}, "restore_input_file": {"args": ["self", "file_type"], "min_max_lineno": {"min_lineno": 719, "max_lineno": 736}, "calls": ["shutil.copyfile"]}, "modify_channel_grid_file": {"args": ["self", "cal_var", "param", "SILENT"], "min_max_lineno": {"min_lineno": 739, "max_lineno": 776}, "calls": ["topoflow.utils.parameterize.get_grid_from_TCA", "topoflow.utils.parameterize.get_grid_from_TCA", "topoflow.utils.parameterize.get_grid_from_TCA", "topoflow.utils.parameterize.get_grid_from_TCA"]}, "compute_cost": {"args": ["self", "SILENT"], "returns": [["cost"]], "min_max_lineno": {"min_lineno": 779, "max_lineno": 814}, "calls": ["calibrate.Lp_norm", "print", "print", "print", "print", "print", "print", "calibrate.spearman_metric"], "store_vars_calls": {"cost": "spearman_metric"}}, "get_parameter_values": {"args": ["self", "var_range", "n"], "returns": [["p_values"]], "min_max_lineno": {"min_lineno": 817, "max_lineno": 832}, "calls": ["numpy.float32", "numpy.float32", "numpy.zeros", "numpy.arange"], "store_vars_calls": {"vmin": "np.float32", "vmax": "np.float32", "p_values": "np.zeros"}}, "calibrate": {"args": ["self", "PLOT", "NORMALIZE_PLOT", "SILENT", "var_range", "n_values", "cal_var", "channel_width_max", "channel_width_power", "manning_n_min", "manning_n_max"], "min_max_lineno": {"min_lineno": 835, "max_lineno": 984}, "calls": ["calibrate.calibrator.backup_input_file", "calibrate.calibrator.get_parameter_values", "numpy.zeros", "time.time", "print", "calibrate.calibrator.restore_input_file", "print", "print", "print", "print", "calibrate.calibrator.modify_channel_grid_file", "time.sleep", "time.time", "topoflow.main.run_model", "calibrate.calibrator.update_sim_data_file", "calibrate.calibrator.get_simulated_values", "calibrate.calibrator.compute_cost", "print", "print", "print", "print", "print", "print", "print", "calibrate.calibrator.get_observed_values", "cal_var.replace().title", "calibrate.calibrator.plot_time_series", "time.time", "time.time", "str", "cal_var.replace"], "store_vars_calls": {"p_values": "self.get_parameter_values", "costs": "np.zeros", "cal_start_time": "time.time", "run_start_time": "time.time", "cost": "self.compute_cost", "str1": "cal_var.replace().title"}}, "plot_time_series": {"args": ["self", "title", "sim_only", "obs_only", "normalize", "marker"], "min_max_lineno": {"min_lineno": 987, "max_lineno": 1019}, "calls": ["min", "topoflow.utils.visualize.plot_data", "y1.max", "y2.max", "topoflow.utils.visualize.plot_data", "topoflow.utils.visualize.plot_data"], "store_vars_calls": {"n": "min"}}, "update_sim_data_file": {"args": ["self", "SILENT"], "min_max_lineno": {"min_lineno": 1022, "max_lineno": 1059}, "calls": ["glob.glob", "fname.endswith", "print", "fname.split", "ending.replace", "numstr.replace.replace.replace", "int"], "store_vars_calls": {"sim_files": "glob.glob", "TEST2": "fname.endswith", "parts1": "fname.split", "numstr": "numstr.replace", "num": "int"}}}}}, "functions": {"test": {"min_max_lineno": {"min_lineno": 62, "max_lineno": 75}, "calls": ["calibrate.calibrator", "calibrate.calibrator.print_cfg_info", "calibrate.calibrator.get_simulated_values", "calibrate.calibrator.get_observed_values", "print", "print", "print", "print", "print", "calibrate.calibrator.compute_cost"], "store_vars_calls": {"c": "calibrator", "cost": "c.compute_cost"}}, "read_any_time_series": {"args": ["txt_file", "hdr_lines", "time_col", "value_col", "SILENT", "time_type", "delim"], "returns": [["times", "values"]], "min_max_lineno": {"min_lineno": 1090, "max_lineno": 1142}, "calls": ["open", "range", "list", "list", "open.close", "numpy.array", "numpy.array", "open.readline", "open.readline", "file_unit.readline.split", "len", "numpy.float32", "np.array.append", "np.array.append", "print", "print", "print", "print", "print", "print", "print", "print", "print", "numpy.float32", "np.array.min", "np.array.max", "np.array.min", "np.array.max"], "store_vars_calls": {"file_unit": "open", "times": "np.array", "values": "np.array", "line": "file_unit.readline", "words": "line.split", "ncols": "len", "value": "np.float32", "time": "np.float32"}}, "compute_rain_rates_from_accumulations": {"args": ["SILENT"], "returns": [["new_rates"]], "min_max_lineno": {"min_lineno": 1145, "max_lineno": 1203}, "calls": ["calibrate.read_any_time_series", "numpy.int16", "scipy.interpolate.interp1d", "np.int16.min", "np.int16.max", "scipy.interpolate.interp1d.", "f1.min", "f1.max", "numpy.roll", "numpy.roll", "numpy.arange", "print", "print", "print", "print", "print", "print", "print", "print", "da.min", "da.max", "dt.min", "dt.max"], "store_vars_calls": {"times_min": "np.int16", "f1": "interp1d", "tmin": "times_min.min", "tmax": "times_min.max", "new_rates": "f1", "rmin": "new_rates.min", "rmax": "new_rates.max"}}, "Lp_norm": {"args": ["Y_obs", "Y_sim", "p"], "returns": [["d"]], "min_max_lineno": {"min_lineno": 1207, "max_lineno": 1215}, "calls": ["numpy.abs", "arg.sum"]}, "Lp_metric": {"args": ["Y_obs", "Y_sim", "p"], "min_max_lineno": {"min_lineno": 1218, "max_lineno": 1221}, "calls": ["calibrate.Lp_norm"]}, "spearman_metric": {"args": ["x", "y"], "returns": [["d"]], "min_max_lineno": {"min_lineno": 1224, "max_lineno": 1243}, "calls": ["scipy.stats.spearmanr"]}}, "is_test": false}