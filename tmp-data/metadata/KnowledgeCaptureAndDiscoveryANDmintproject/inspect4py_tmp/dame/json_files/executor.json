{"file": {"path": "/Users/dakixr/Desktop/github/scc/tmp-data/metadata/KnowledgeCaptureAndDiscoveryANDmintproject/dame_cli/src/dame/executor.py", "fileNameBase": "executor", "extension": "py"}, "dependencies": [{"import": "shutil", "type": "external"}, {"import": "uuid", "type": "external"}, {"from_module": "pathlib", "import": "Path", "type": "external"}, {"import": "docker", "type": "external"}, {"import": "validators", "type": "external"}, {"from_module": "yaml", "import": "load", "type": "external"}, {"from_module": "yaml", "import": "Loader", "type": "external"}, {"from_module": "dame.utils", "import": "download_extract_zip", "type": "external"}, {"from_module": "dame.utils", "import": "obtain_id", "type": "external"}, {"from_module": "dame.utils", "import": "convert_object_to_dict", "type": "external"}, {"from_module": "dame.utils", "import": "download_data_file", "type": "external"}], "functions": {"get_engine": {"returns": [["DOCKER_ENGINE"]], "min_max_lineno": {"min_lineno": 18, "max_lineno": 25}, "calls": ["docker.from_env", "docker.from_env.info"], "store_vars_calls": {"client": "docker.from_env"}}, "get_file": {"doc": {"short_description": "Get the files from a url or the", "args": {"destination_dir": {"description": "The destination directory"}}, "returns": {"description": "The filename of the file. Must be the filename", "is_generator": false}}, "args": ["destination_dir", "url", "_format"], "min_max_lineno": {"min_lineno": 27, "max_lineno": 44}, "calls": ["validators.url", "dame.utils.download_data_file", "pathlib.Path().is_file", "pathlib.Path", "pathlib.Path", "shutil.copy", "str", "str", "pathlib.Path"]}, "build_input": {"doc": {"short_description": "Download or search the file. Loop the inputs (metadata) of Model Configuration or Model Configuration Setup", "args": {"inputs": {"description": "A dictionary following DataSpecificationFile"}, "destination_dir": {"description": "The destination directory"}, "data_dir": {"description": "The local directory where the files are"}}, "returns": {"is_generator": false}}, "args": ["inputs", "destination_dir"], "returns": [["line"]], "min_max_lineno": {"min_lineno": 46, "max_lineno": 75}, "calls": ["dame.utils.convert_object_to_dict", "ValueError", "executor.get_file", "dame.utils.convert_object_to_dict.keys"], "store_vars_calls": {"_input": "convert_object_to_dict", "file_name": "get_file"}}, "build_output": {"args": ["outputs"], "returns": [["line"]], "min_max_lineno": {"min_lineno": 77, "max_lineno": 88}, "calls": ["dame.utils.convert_object_to_dict", "ValueError", "dame.utils.convert_object_to_dict.keys"], "store_vars_calls": {"_output": "convert_object_to_dict"}}, "build_parameter": {"args": ["parameters"], "returns": [["line"]], "min_max_lineno": {"min_lineno": 90, "max_lineno": 107}, "calls": ["dame.utils.convert_object_to_dict", "ValueError", "dame.utils.convert_object_to_dict.keys"], "store_vars_calls": {"_parameter": "convert_object_to_dict"}}, "check_if_cwl_compatible": {"args": ["resource"], "min_max_lineno": {"min_lineno": 108, "max_lineno": 113}, "calls": ["pathlib.Path"]}, "build_command_line": {"args": ["resource", "_dir"], "returns": [["has_software_image", "line", "src_path"]], "min_max_lineno": {"min_lineno": 116, "max_lineno": 144}, "calls": ["dame.utils.obtain_id", "dame.utils.download_extract_zip", "pathlib.Path", "ValueError", "executor.build_input", "executor.build_output", "executor.build_parameter"], "store_vars_calls": {"setup_name": "obtain_id", "component_dir": "download_extract_zip", "path": "Path", "l": "build_parameter"}}, "prepare_execution": {"doc": {"short_description": "Create the execution directory and call the method to get the inputs and execution line", "args": {"setup_path": {"description": "the path of the YAML file"}}, "returns": {"description": "- src_path: (:py:class:`Path`) - Path component source directory\n- execution_dir: (:py:class:`Path`) - Path execution directory\n- setup_cmd_line: (:py:class:`Path`) - The execution line (./run)\n- setup_name: (:py:class:`Path`) - The name of setup\n- image: (:py:class:`Path`) - The name of the image", "is_generator": false}}, "args": ["setup_path"], "returns": [["src_path", "execution_dir", "setup_cmd_line", "setup_name", "image"]], "min_max_lineno": {"min_lineno": 146, "max_lineno": 173}, "calls": ["pathlib.Path", "pathlib.Path.mkdir", "yaml.load", "dame.utils.obtain_id", "pathlib.Path", "pathlib.Path.mkdir", "setup_path.open", "uuid.uuid1", "executor.build_command_line"], "store_vars_calls": {"_dir": "Path", "setup_dict": "load", "setup_name": "obtain_id", "execution_dir_path": "Path"}}, "docker_pull": {"args": ["client", "image"], "min_max_lineno": {"min_lineno": 175, "max_lineno": 188}, "calls": ["docker.APIClient", "docker.APIClient.pull", "print"], "store_vars_calls": {"client": "docker.APIClient", "result_itr": "client.pull"}}, "run_docker": {"args": ["component_cmd", "execution_dir", "component_dir", "setup_name", "image", "volumes"], "min_max_lineno": {"min_lineno": 190, "max_lineno": 207}, "calls": ["docker.from_env", "executor.docker_pull", "docker.from_env.containers.run", "open", "client.containers.run.logs", "print", "log_file.write", "chunk.decode"], "store_vars_calls": {"client": "docker.from_env", "res": "client.containers.run"}}, "get_docker_cmd": {"args": ["image", "setup_cmd_line", "mint_volumes"], "min_max_lineno": {"min_lineno": 210, "max_lineno": 217}, "calls": ["mint_volumes.keys"]}}, "is_test": false}